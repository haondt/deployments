components:
  primary:
    image: lscr.io/linuxserver/wireguard:latest@sha256:1224125679b8f4f48808ccbb4eb138af25f945ca375e0f63576d64ea15bebf62
    talos: +!
    
    networking:
      ports:
        udp:
          port: 51820
          protocol: UDP
      ip_addresses:
        - ip: 192.168.1.102
          ports: [udp]
    volumes:
      modules:
        src.host.dir: /lib/modules
        dest.dir: /lib/modules
      config:
        src.pvc.size: 64Mi
        dest.dir: /config
    security:
      cap.add:
        - NET_ADMIN
        - SYS_MODULE
      sysctls:
        - net.ipv4.ip_forward
    environment:
      - raw:
          SERVERPORT: 52820
          PEERS: 1
      - raw:
          SERVERURL: "{{ haondt__cluster_ip }}"
        secret: true



