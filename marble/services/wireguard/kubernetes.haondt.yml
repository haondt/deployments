spec:
  components:
    primary:
      spec:
        image: ghcr.io/wg-easy/wg-easy
        x-tl: +!
        networking:
          ports:
            udp:
              port: 51820
              protocol: UDP
            http: 51821
          ip_addresses:
            - ip: 192.168.1.102
              ports: [udp]
          ingresses:
            - port: http
              host: "wg-easy.{{ haondt__default_host }}"
              tls.host: "*.{{ haondt__default_host }}"
        volumes:
          - src.host_dir: /lib/modules
            dest.dir: /lib/modules
          - src.pvc.size: 256Mi
            dest.dir: /etc/wireguard
        environment:
          - raw:
              WG_PORT: 51821
          - raw:
              WG_HOST: "{{ haondt__cluster_ip }}"
            secret: True
        security.cap.add:
          - NET_ADMIN
          - SYS_MODULE
