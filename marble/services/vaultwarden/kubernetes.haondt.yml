components:
  primary:
    image: docker.io/vaultwarden/server:1.35.3@sha256:1ca2e2098ba9ab9e46004f4ee61a3be6080ffee3ed41018a95c4b0fb6454a54b
    talos: "+:!!!?"
    networking:
      ports:
        http: 80
      gateway.http_routes:
        - port: http
          host: "vaultwarden.{{ haondt__default_host }}"
    observability:
      probes.hc:
        http_get:
          port: http
          path: /alive
        alloy.blackbox: {}
    volumes:
      data:
        src.pvc: {}
        dest.dir: /data
    charon:
      overlays: [daily]
      backups:
        - overlays: [default-gcs]
          repository_configs: &charon_repository_configs
            - raw: |-
                backend:
                  path: vaultwarden-primary
          source.volumes: &charon_source
            data: [/]
        - overlays: [default-hzsb]
          repository_configs: *charon_repository_configs
          source.volumes: *charon_source
