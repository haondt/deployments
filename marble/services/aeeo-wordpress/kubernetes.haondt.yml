components:
  primary:
    image: docker.io/library/wordpress:latest@sha256:30bff39330d1693b0ce13d32fc9b7bb67193064f040b7d60d3494e136fa599d4
    talos: +!
    networking:
      ports:
        http: 80
      dependencies:
        - name: db
          port: http
      rathole_routes:
        - port: http
          host: "{{ aeeo__domain }}"
    volumes:
      config:
        src.pvc: {}
        dest.dir: /var/www/html
    environment:
      - raw:
          WORDPRESS_DB_HOST: aeeo-wordpress-db-http:8080
          WORDPRESS_DB_USER: aeeowordpress
          WORDPRESS_DB_PASSWORD: aeeowordpress
          WORDPRESS_DB_NAME: aeeowordpress
  db:
    image: docker.io/library/mariadb:12@sha256:e1bcd6f85781f4a875abefb11c4166c1d79e4237c23de597bf0df81fec225b40
    talos: ^!
    args: ['--default-authentication-plugin=mysql_native_password']
    networking:
      ports:
        http: 3306
    volumes:
      db-data:
        src.pvc: {}
        dest.dir: /var/lib/mysql
    environment:
      - raw: 
          MYSQL_ROOT_PASSWORD: aeeowordpress
          MYSQL_DATABASE: aeeowordpress
          MYSQL_USER: aeeowordpress
          MYSQL_PASSWORD: aeeowordpress
