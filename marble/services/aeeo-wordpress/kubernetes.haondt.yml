components:
  primary:
    image: docker.io/library/wordpress:latest@sha256:1b5fee9f90d12c7fcba8b0bcb0f9d94166daa1086b7559def66d62e5c9b7c947
    talos: +!
    networking:
      ports:
        http: 80
      dependencies:
        - name: db
          port: http
      rathole_routes:
        - port: http
          host: "{{ aeeo__domain }}"
    volumes:
      config:
        src.pvc: {}
        dest.dir: /var/www/html
    environment:
      - raw:
          WORDPRESS_DB_HOST: aeeo-wordpress-db:3306
          WORDPRESS_DB_USER: aeeowordpress
          WORDPRESS_DB_PASSWORD: aeeowordpress
          WORDPRESS_DB_NAME: aeeowordpress
  db:
    image: docker.io/library/mariadb:12@sha256:e487701b1f7e3f47319fe005b417c72becb67824a58b7bd35c6505f070f66dcd
    talos: ^!
    args: ['--default-authentication-plugin=mysql_native_password']
    networking:
      ports:
        http: 3306
    volumes:
      db-data:
        src.pvc: {}
        dest.dir: /var/lib/mysql
    environment:
      - raw: 
          MYSQL_ROOT_PASSWORD: aeeowordpress
          MYSQL_DATABASE: aeeowordpress
          MYSQL_USER: aeeowordpress
          MYSQL_PASSWORD: aeeowordpress
