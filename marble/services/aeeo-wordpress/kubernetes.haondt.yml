components:
  primary:
    image: docker.io/library/wordpress:latest@sha256:c9f42b6d7789a95d7d9eb0f9caea42f3d8bac1ddc36745200b5b4014feec5767
    talos: +!
    networking:
      ports:
        http: 80
      dependencies:
        - name: db
          port: http
      rathole_routes:
        - port: http
          host: "{{ aeeo__domain }}"
    volumes:
      config:
        src.pvc: {}
        dest.dir: /var/www/html
    environment:
      - raw:
          WORDPRESS_DB_HOST: aeeo-wordpress-db-http:8080
          WORDPRESS_DB_USER: aeeowordpress
          WORDPRESS_DB_PASSWORD: aeeowordpress
          WORDPRESS_DB_NAME: aeeowordpress
  db:
    image: docker.io/library/mariadb:12@sha256:607835cd628b78e2876f6a586d0ec37b296c47683b31ef750002d3d17d3d8f7a
    talos: ^!
    args: ['--default-authentication-plugin=mysql_native_password']
    networking:
      ports:
        http: 3306
    volumes:
      db-data:
        src.pvc: {}
        dest.dir: /var/lib/mysql
    environment:
      - raw: 
          MYSQL_ROOT_PASSWORD: aeeowordpress
          MYSQL_DATABASE: aeeowordpress
          MYSQL_USER: aeeowordpress
          MYSQL_PASSWORD: aeeowordpress
