components:
  primary:
    image: ghcr.io/arabcoders/watchstate:latest@sha256:47143eaa49135dfcdb3bbc351046c81ec1cfa7bf3c6a0141b08ed7b9c32b03d7
    talos: +!
    resources.requests.memory: 256Mi
    resources.limits.memory: 4Gi
    networking:
      ports:
        http: 8080
      gateway.http_routes:
        - port: http
          host: "watchstate.{{ haondt__default_host }}"
    observability.probes.hc:
      http_get:
        port: http
        path: /v1/api/system/healthcheck
      alloy.blackbox: {}
    security:
      user: 1000
      group: 1000
    volumes:
      config:
        src.pvc.size: 4Gi
        dest.dir: /config
    startup:
      tasks:
        - chown:
            paths: [/config]
            owner: '1000:1000'
